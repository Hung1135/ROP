<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Tất cả công ty - ROP</title>
    <link rel="stylesheet" href="{% static 'app/css_user/detailPost.css' %}"/>

    <link rel="stylesheet" href="{% static 'app/css_user/home.css' %}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>
<body>
    {% include "user/header.html" %}

    <main class="container" style="padding: 40px 20px;">
        <h2 style="text-align: center; color: #0056b3;">AI TÌM VIỆC PHÙ HỢP</h2>
        
        <section style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 30px;">
            <form method="GET" action="{% url 'matching_jobs' %}">
                <label><b>Chọn hồ sơ của bạn:</b></label>
                <select name="cv_id" onchange="this.form.submit()" style="padding: 10px; width: 100%; border-radius: 5px;">
                    <option value="">-- Vui lòng chọn một hồ sơ để AI phân tích --</option>
                    {% for cv in user_cvs %}
                        <option value="{{ cv.id }}" {% if selected_cv_id == cv.id %}selected{% endif %}>
                            {{ cv.full_name }} - Ngày tạo: {{ cv.uploaded_at|date:"d/m/Y" }}
                        </option>
                    {% endfor %}
                </select>
            </form>
        </section>
    
        <div class="job-list">
            {% for item in recommended_jobs %}
                <div class="job-card" style="border: 1px solid #ddd; margin-bottom: 20px; padding: 20px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; border-left: 10px solid 
                    {% if item.percent >= 70 %}#28a745{% elif item.percent >= 40 %}#ffc107{% else %}#dc3545{% endif %};">
                    
                    <div>
                        <h3 style="margin: 0;">{{ item.job.title }}</h3>
                        <p style="margin: 5px 0; color: #666;"><i class="fas fa-building"></i> {{ item.job.company }}</p>
                        <p style="font-size: 13px; color: #888;">Địa điểm: {{ item.job.location }}</p>
                    </div>
    
                    <div style="text-align: right;">
                        <div style="font-size: 24px; font-weight: bold; color: {% if item.percent >= 70 %}#28a745{% else %}#333{% endif %};">
                            {{ item.percent }}%
                        </div>
                        <div style="font-weight: bold; font-size: 14px;">{{ item.level }}</div>
                        <a href="{% url 'detailPost' item.job.id %}?cv_id={{ selected_cv_id }}" 
   style="display: inline-block; margin-top: 10px; background: #0056b3; color: #fff; padding: 5px 15px; border-radius: 5px; text-decoration: none;">
   Xem chi tiết
</a>
                 </div>
                </div>
            {% empty %}
                {% if selected_cv_id %}
                    <p style="text-align: center;">Không tìm thấy bài đăng nào phù hợp.</p>
                {% else %}
                    <p style="text-align: center; color: #888;">Hãy chọn một CV phía trên để hệ thống AI gợi ý việc làm cho bạn.</p>
                {% endif %}
            {% endfor %}
        </div>
    </main>
    <footer>
        <p>&copy; 2025 JobFinder. All rights reserved.</p>
      </footer>
</body>
</html>